<full-calendar [events]="events" [options]="calendarOptions" (onDateClick)="onDateClick($event)"
  (onEventClick)="onEventClick($event)">
</full-calendar>
<ng-template #modalNotification let-modal>
  <div class="modal-body p-4">
    <div class="card shadow-sm border-0">
      <div class="card-body d-flex">
        <div class="me-3">
          <div class="p-3 rounded-circle d-flex align-items-center justify-content-center"
               [ngClass]="{
                 'bg-warning': notification_selectionnee?.type === 'rappel_facturation',
                 'bg-info': notification_selectionnee?.type === 'suivi_facture',
                 'bg-primary': notification_selectionnee?.type !== 'rappel_facturation' && notification_selectionnee?.type !== 'suivi_facture'
               }">
            <i class="fs-3 text-white"
               [ngClass]="{
                 'bi bi-exclamation-triangle-fill': notification_selectionnee?.type === 'rappel_facturation',
                 'bi bi-receipt-cutoff': notification_selectionnee?.type === 'suivi_facture',
                 'bi bi-bell-fill': notification_selectionnee?.type !== 'rappel_facturation' && notification_selectionnee?.type !== 'suivi_facture'
               }"></i>
          </div>
        </div>
        <div class="flex-grow-1">
          <h5 class="card-title mb-2 text-capitalize">
            {{ (notification_selectionnee?.type=="suivi_facture")?"Suivi Facture":"Rappel Facture" }}
          </h5>
          <p class="card-text">{{ notification_selectionnee?.message }}</p>
          <div class="text-muted small">
            <!-- ðŸ“… Ã‰chÃ©ance : {{ notification_selectionnee?.date_echeance | date:'fullDate' }} -->
            ðŸ“… Ã‰chÃ©ance : {{ moment_format( notification_selectionnee?.date_echeance) }}
          </div>
        </div>
      </div>
    </div>

    <div class="d-flex justify-content-end mt-4 gap-2">
      <button *ngIf="notification_selectionnee?.id_facture" class="btn btn-primary"
              (click)="aller_facture(notification_selectionnee); modal.close()">
        Aller Ã  la facture
      </button>
      <button *ngIf="notification_selectionnee?.id_facture==0" class="btn btn-primary"
              (click)="aller_facture(notification_selectionnee); modal.close()">
        Aller au projet
      </button>
      <button class="btn btn-outline-secondary" (click)="modal.close()">Fermer</button>
    </div>
  </div>
</ng-template>


<div class="dropdown-header px-0 text-wrap header-notification-scroll">
  <div class="list-group list-group-flush w-100">
    @for (notif of les_notifications; track $index) {
    <a class="list-group-item list-group-item-action" (click)="aller_facture(notif)">
      <div class="d-flex">
        <div class="flex-shrink-0">
          <div class="user-avatar bg-light-warning">
            <!-- <i class="d-flex" antIcon theme="outline" type="bell"></i> -->
            <i class="d-flex  p-2 fs-4 " [ngClass]="notif.jours_restants <= 5 ? 'text-danger' : 'text-warning'" antIcon
              theme="outline" type="bell">
            </i>

          </div>
        </div>
        <div class="flex-grow-1 ms-3">
          <span class="float-end text-muted">{{ api.format_date( notif.created_at).jma2_hour}} <br>
            @if (notif.lue==1) {
              <i class="bi bi-check2-all text-primary"> Vu</i>
            }
          </span>
          <p class="text-body mb-1">
            {{ notif.message }}
          </p>
          <span class="text-muted">{{ api.get_relative_date(notif.date_echeance) }}</span>
        </div>
      </div>
    </a>
    }
  </div>
</div>
